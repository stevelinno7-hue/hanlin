<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI è‡ªå‹•è£‚è®Šå‡ºé¡Œç³»çµ±</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: #f4f7f6; padding: 20px; color: #333; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
        h1 { color: #2c3e50; text-align: center; margin-bottom: 30px; }
        .controls { display: flex; gap: 10px; margin-bottom: 30px; flex-wrap: wrap; background: #f8f9fa; padding: 15px; border-radius: 8px; }
        select, button { padding: 10px 15px; border-radius: 6px; border: 1px solid #ddd; font-size: 16px; }
        button { background: #007bff; color: white; border: none; cursor: pointer; transition: 0.2s; flex-grow: 1; }
        button:hover { background: #0056b3; }
        .question-card { border-bottom: 1px solid #eee; padding: 20px 0; animation: fadeIn 0.5s ease forwards; }
        .question-text { font-size: 18px; font-weight: 600; margin-bottom: 15px; line-height: 1.5; white-space: pre-wrap; }
        .options { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .option { background: #f1f3f5; padding: 10px; border-radius: 6px; font-size: 15px; border: 1px solid #e9ecef; }
        .badge { display: inline-block; padding: 2px 8px; background: #e2e3e5; border-radius: 4px; font-size: 12px; margin-bottom: 8px; }
        .fission-badge { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ“ è‡ªå‹•åŒ–è€ƒå·ç”Ÿæˆå™¨</h1>

    <div class="controls">
        <select id="subjectSelect">
            <option value="math">æ•¸å­¸</option>
            <option value="english">è‹±æ–‡</option>
            <option value="chinese">åœ‹æ–‡</option>
            <option value="physics">ç‰©ç†</option>
            <option value="chemistry">åŒ–å­¸</option>
            <option value="biology">ç”Ÿç‰©</option>
            <option value="history">æ­·å²</option>
            <option value="geography">åœ°ç†</option>
            <option value="civics">å…¬æ°‘</option>
        </select>
        <select id="gradeSelect">
            <option value="åœ‹ä¸ƒ">åœ‹ä¸ƒ</option>
            <option value="åœ‹å…«">åœ‹å…«</option>
            <option value="åœ‹ä¹">åœ‹ä¹</option>
            <option value="é«˜ä¸€">é«˜ä¸€</option>
        </select>
        <button onclick="generate()">é–‹å§‹ç”Ÿæˆé¡Œç›®</button>
    </div>

    <div id="examPaper">
        <p style="text-align: center; color: #999;">è«‹é¸æ“‡ç§‘ç›®èˆ‡å¹´ç´šå¾Œé»æ“Šç”Ÿæˆ</p>
    </div>
</div>

<script>
    window.RigorousGenerator = {
        _templates: {},
        _templateTags: {},
        utils: {
            pick: (arr) => arr[Math.floor(Math.random() * arr.length)],
            shuffle: (arr) => [...arr].sort(() => Math.random() - 0.5),
            randInt: (min, max) => Math.floor(Math.random() * (max - min + 1)) + min,
            generateNumericOptions: (ans, type) => {
                const step = type === 'float' ? 0.5 : 1;
                return [ans, ans + step, ans - step, ans + step * 2];
            }
        },
        registerTemplate: function(id, func, tags = []) {
            this._templates[id] = func;
            this._templateTags[id] = tags;
        },
        generateQuestion: function(id) {
            const ctx = { tags: this._templateTags[id] || [] };
            return this._templates[id](ctx, Math.random());
        }
    };
</script>

<script src="AutoTemplateFissionFactory.js"></script>
<script src="auto_fission_bootstrap.js"></script>

<script src="templates_math_algebra_geometry.js"></script>
<script src="templates_english_core.js"></script>
<script src="templates_chinese_core.js"></script>
<script src="templates_physics_multistep.js"></script>
<script src="templates_chemistry_core.js"></script>
<script src="templates_biology_core.js"></script>
<script src="templates_history_core.js"></script>
<script src="templates_geography_core.js"></script>
<script src="templates_civics_core.js"></script>

<script src="paper_generator.js"></script>

<script>
    function generate() {
        const subject = document.getElementById('subjectSelect').value;
        const grade = document.getElementById('gradeSelect').value;
        const container = document.getElementById('examPaper');
        
        // ä½¿ç”¨ paper_generator.js æä¾›çš„å‡½å¼
        const questions = window.generatePaper({
            subject: subject,
            total: 5,
            tags: [grade]
        });

        container.innerHTML = '';
        
        if (questions.length === 0) {
            container.innerHTML = '<p style="color:red; text-align:center;">æ‰¾ä¸åˆ°ç¬¦åˆæ¨™ç±¤çš„é¡Œç›®ã€‚</p>';
            return;
        }

        questions.forEach((q, index) => {
            const isFission = q.templateId && q.templateId.includes('fission');
            const card = document.createElement('div');
            card.className = 'question-card';
            card.innerHTML = `
                <div class="badge ${isFission ? 'fission-badge' : ''}">
                    ${isFission ? 'âœ¨ ç´ é¤Šè®Šé«”' : 'ğŸ“– æ¨™æº–é¡Œå‹'} | ${q.concept || 'æ ¸å¿ƒè§€å¿µ'}
                </div>
                <div class="question-text">${index + 1}. ${q.question}</div>
                <div class="options">
                    ${q.options.map((opt, i) => `<div class="option">${String.fromCharCode(65+i)}. ${opt}</div>`).join('')}
                </div>
            `;
            container.appendChild(card);
        });
    }
</script>

</body>
</html>
